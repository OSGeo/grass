<h2>DESCRIPTION</h2>

The <em>m.nviz.script</em> program allows the user to easily create a script
that can be run in NVIZ to fly through a terrain.

The NVIZ flight path can be chosen interactively from the GRASS
monitor (<em>-i</em>) or supplied on the command line as comma
separated coordinates. The program optionally allows a KeyFrame
file to created (after running the script). This KeyFrame file can
be loaded into the <em>Keyframe Animation</em> panel for fine
tuning or editing.

<p>
The script generated by <em>m.nviz.script</em> can be run from the NVIZ
command line (nviz script=script_name) or after NVIZ is started by
selecting <em>Scripting->Play Script</em>.

<h2>OPTIONS</h2>

<H3>Flags:</H3>
<DL>
<DT><B>-i</B>
<DD>Intercative mode
<DD>The user selects the camera path from the GRASS monitor by
	clicking the left mouse button along the route. Click the
	right mouse button to finish.
<DT><B>-f</B>
<DD>Full render
<DD>The script will draw all loaded NVIZ data and save scene to PPM image.
<DT><B>-c</B>
<DD>Flay at constant elevation
<DD>With this flag the camera will be set to an elevation given by the
	<em>ht=</em> parameter. The default is to fly at <em>ht=</em>
	above the topography (i.e. camera height = elevation + ht)
<DT><B>-k</B>
<DD>Output KeyFrame file
<DD>Generate a KeyFrame file that can be loaded from the NVIZ
	<em>Keyframe Animation</em> panel. The KeyFrame file is
	automatically assigned the script name with a
	<em>.kanimator</em> extension.
<DT><B>-o</B>
<DD>Render the animation in an off-screen context
<DT><B>-e</B>
<DD>Enable vector and sites drawing
</DL>


<H3>Parameters:</H3>
<DL>
<DT><B>input</B>
<DD>The name of the GRASS raster map with elevation data. 
<DD>This should be the same file that will be loaded in NVIZ.

<DT><B>output</B>
<DD>The name of the NVIZ script to create.

<DT><B>name</B>
<DD>The prefix for output images if running in full render mode (<em>-f</em>).
<DD>The defulat preifix is NVIZ (eg. NVIZ0000.ppm).

<DT><B>dist</B>
<DD>The distance of the camera behind the center of view.

<DT><B>ht</B>
<DD>The height of the camera above the center of view.
<DD>If the the <em>-c</em> flag is set, the height represents the actual camera height.

<DT><B>frames</B>
<DD>The number of frames in the animation.

<DT><B>start</B>
<DD>The starting frame number (default = 0).
<DD> This option may be useful in full render mode when creating an
animation in sections. For example the user may wish to start at frame
number 2000.

<DT><B>route</B>
<DD>The comma separated geographic coordinates for keyframe locations.
<DD>The interactive flag (<em>-i</em>) overrides this option.

</DL>

<h2>EXAMPLE</h2>
To interactively create an NVIZ animation from raster elev.rast with
500 frames and the camera set to 50 meters above and 250 meters behind
the scene, run the following:

<div class="code"><pre>
g.region rast=elevation.dem
d.rast elevation.dem
m.nviz.script -ik input=elevation.dem output=nviz.script dist=2400 ht=1220 frames=1000
</pre></div>
In the above the example the user is prompted to select the route from the GRASS monitor.
The output script, 'nviz.script.nvscr', can then be run in NVIZ:
<div class="code"><pre>
nviz elevation=elevation.dem script=nviz.script.nvscr
</pre></div>

<h2>NOTES / HINTS</h2>
The user must select at least four key-frame locations (points)
 otherwise an error is generated.
<p>
If the GRASS region is changed the <em>m.nviz.script</em> command must be re-run.
<p>
The current GRASS region and the user supplied parameters are included
as a comment at the top of the output script. This information can be
used to easily re-create the animation.
<p>
The camera position is calculated backwards from the supplied
position(s). It is possible that the camera position will lie outside
the current window, in which case a non-fatal error is generated
(Error: selected point is outside region).  This error can result in
jerky movements during the animation.  To correct this problem reduce
the <em>dist=</em> parameter or increase the current region.

<h3>Loading the script into NVIZ</h3>

The user can run the script at arbitrary resolution. To re-run it at
higher spatial resolution or different settings, the user first loads
the surface and sets the resolution, lighting, etc. Then internally
the script generated by <em>m.nviz.script</em> is run. Alternatively, the
user can run nviz with a previuosly saved state and the
<em>m.nviz.script</em> generated script:

<div class="code"><pre>
nviz state=saved.state script=nviz.script.nvscr
</pre></div>

<h3>Keyframe animator script</h3>
Running the script generated by <em>m.nviz.script</em> within NVIZ, a new script for
kanimator (keyframe animator) is created. The kanimator panel offers
fine tuning of the speed (frame rate) as well as editing individual
frames or inserting new frames. This new kanimator script has to be
loaded from the Kanimator panel in NVIZ. In the Kanimator panel there
are Save and Load button which allow the user to save and re-load a
kanimator script. Once loaded, the key frames will appear in the GUI
and can then be edited there.

<h2>SEE ALSO</h2>

<em><a href="nviz.html">nviz</A></em>

<h2>AUTHOR</h2>

<a href="mailto:bcovill@tekmap.ns.ca">Bob Covill</A>
<p><i>Last changed: $Date$</i>
